@startuml Контекстная_диаграмма_Альтернативное_решение

!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Context.puml

LAYOUT_WITH_LEGEND()

title Контекстная диаграмма - Система мониторинга скота (Альтернативное решение)

Person(оператор, "Оператор фермы", "Сотрудник, отвечающий за мониторинг скота на ферме")
Person(дежурный, "Дежурный сотрудник", "Сотрудник, получающий уведомления при отсутствии интернета")
Person(аналитик, "Аналитик", "Сотрудник для анализа данных и отчетности")
Person(администратор, "Администратор системы", "Управление пользователями и настройками")

System_Boundary(система_мониторинга, "Система мониторинга скота") {
    System(центральный_сервер, "Центральный сервер", "Основная система управления и аналитики")
    System(edge_вычислитель, "Edge вычислитель", "Локальный сервер для обработки видео и IoT данных")
    System(локальная_база, "Локальная база данных", "Хранение данных на ферме")
}

System_Ext(erp, "ERP система (1С:Агро)", "Существующая система учета")
System_Ext(kafka, "Kafka (существующая)", "Брокер сообщений для интеграции")
System_Ext(bi, "BI система", "Существующая система отчетности")
System_Ext(мобильное_приложение, "Мобильное приложение", "Существующее приложение для агрономов")

System_Ext(камеры, "IP камеры", "Видеокамеры для мониторинга")
System_Ext(датчики_кормушки, "Датчики кормушек", "IoT датчики кормушек разных производителей")
System_Ext(датчики_поилки, "Датчики поилок", "IoT датчики поилок")
System_Ext(датчики_фильтрации, "Датчики фильтрации воды", "Мониторинг качества воды")
System_Ext(датчики_запасов, "Датчики запасов корма", "Мониторинг количества корма")

System_Ext(нейросеть, "Нейросетевая модель", "Готовая модель от партнеров для анализа видео")

' Основные взаимодействия
Rel(оператор, edge_вычислитель, "Мониторинг и управление", "Web UI")
Rel(дежурный, edge_вычислитель, "Получение уведомлений", "SMS/Локальные уведомления")
Rel(аналитик, центральный_сервер, "Анализ данных", "Web UI")
Rel(администратор, центральный_сервер, "Управление системой", "Web UI")

' Интеграция с существующими системами
Rel(центральный_сервер, erp, "Передача метрик", "REST API")
Rel(центральный_сервер, kafka, "Публикация событий", "Kafka Protocol")
Rel(центральный_сервер, bi, "Передача данных для отчетов", "ODBC")
Rel(центральный_сервер, мобильное_приложение, "API для мобильного приложения", "REST API")

' Взаимодействие с IoT устройствами
Rel(камеры, edge_вычислитель, "Видеопоток", "RTSP/HTTP")
Rel(датчики_кормушки, edge_вычислитель, "Данные о состоянии", "MQTT/LoRaWAN")
Rel(датчики_поилки, edge_вычислитель, "Данные о состоянии", "MQTT/LoRaWAN")
Rel(датчики_фильтрации, edge_вычислитель, "Данные о качестве воды", "MQTT/LoRaWAN")
Rel(датчики_запасов, edge_вычислитель, "Данные о количестве корма", "MQTT/LoRaWAN")

' Локальная обработка и хранение
Rel(edge_вычислитель, локальная_база, "Сохранение данных", "SQL")
Rel(edge_вычислитель, нейросеть, "Анализ видео", "HTTP API")

' Синхронизация с центральным сервером
Rel(edge_вычислитель, центральный_сервер, "Синхронизация данных", "HTTPS (batch режим)")

@enduml 